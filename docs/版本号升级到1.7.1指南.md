# 版本号升级到 1.7.1 指南

## 概述

项目有一个版本同步脚本 `scripts/sync-version.cjs`，它以 `src-tauri/tauri.conf.json` 为**唯一版本源**，自动同步到 `package.json`、`Cargo.toml` 和 `.exe.manifest`。

UI 界面上的版本号（侧边栏 + 关于对话框）是通过 Tauri 后端 `get_app_version` 命令动态读取的，**不需要手动改前端代码**。

---

## 需要修改的文件

### 1. `src-tauri/tauri.conf.json`（主版本源）

**行 4**，将：
```json
"version": "1.7.0",
```
改为：
```json
"version": "1.7.1",
```

### 2. `package.json`

**行 4**，将：
```json
"version": "1.7.0",
```
改为：
```json
"version": "1.7.1",
```

### 3. `src-tauri/Cargo.toml`

**行 3**，将：
```toml
version = "1.7.0"
```
改为：
```toml
version = "1.7.1"
```

---

## 快捷方式（推荐）

只改第 1 个文件 `src-tauri/tauri.conf.json`，然后运行同步脚本自动更新其余文件：

```bash
node scripts/sync-version.cjs
```

脚本会自动同步：
- `package.json`
- `src-tauri/Cargo.toml`
- `src-tauri/windsurf-account-manager.exe.manifest`（如存在）

---

## 无需手动修改的部分

| 位置 | 原因 |
|------|------|
| `src-tauri/build.rs` | 构建时通过 `CARGO_PKG_VERSION` 环境变量自动从 `Cargo.toml` 读取 |
| `src/views/MainLayout.vue` 侧边栏版本号 | 通过 `invoke('get_app_version')` 动态获取 |
| `src/components/AboutDialog.vue` 关于对话框版本号 | 同上，动态获取 |
| `.exe.manifest` 中的版本 | `build.rs` 构建时自动生成，或由同步脚本更新 |

---

## 总结

**最少操作**：改 `src-tauri/tauri.conf.json` 一个文件 → 跑 `node scripts/sync-version.cjs` → 完成。
